<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Configuring The Harmony Core Library" />
<meta name="DC.relation" scheme="URI" content="GUID-C04D97AB-D6E0-4CF5-9A80-CA64E36B6199.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="configuring-the-harmony-core-library" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Configuring The Harmony Core Library</title>
<meta name="Microsoft.Help.Id" content="GUID-EDFB1AB8-CD6B-446F-8E25-F2167287A1AF-configuring-the-harmony-core-library" />
<meta name="Microsoft.Help.TocParent" content="GUID-EDFB1AB8-CD6B-446F-8E25-F2167287A1AF" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB® Harmony Core Library Reference A 11/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-F1244C57-71EF-492B-8104-473C8CECC20F"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="configuring-the-harmony-core-library">
<h1 class="title topictitle1" id="ariaid-title1">Configuring The Harmony Core Library</h1><div class="body"><p class="p">Harmony Core library component provides common configurations to drivers, system services and middlewares.</p>
<p class="p">It also provides options to <strong class="ph b">create application template files</strong> for the user to kick-start on developing the application.</p>
<p class="p"><strong class="ph b">Key points to be noted</strong></p>
<ul class="ul"><li class="li"><p class="p">All the drivers, system services and middlewares are dependent on the <strong class="ph b">Harmony Core</strong> component.</p>
<ul class="ul"><li class="li"><p class="p">If you add any of these modules in project graph and <strong class="ph b">Harmony core</strong> component is not already activated, a pop-up appears to activate <strong class="ph b">Harmony core</strong></p>
</li>
<li class="li"><p class="p">Failure to activate <strong class="ph b">Harmony Core</strong> component may result in build failures as these modules are dependent on it.</p>
</li>
</ul>
</li>
<li class="li"><p class="p">As <strong class="ph b">Harmony Core</strong> component is dependent on <strong class="ph b">RTOS</strong>, a pop-up will appear the first time <strong class="ph b">Harmony Core</strong> is activated to add <strong class="ph b">FreeRTOS</strong> if it was cloned. <strong class="ph b">As this is optional dependency</strong> user can choose to not activate it.</p>
<ul class="ul"><li class="li"><p class="p">If FreeRTOS is activated, all the existing modules will run in RTOS environment and each module may have its own RTOS settings.</p>
</li>
<li class="li"><p class="p">If not activated, all the existing modules will run in Bare-Metal environment.</p>
</li>
</ul>
</li>
</ul>
<p class="p">The following figures show the MHC configuration window for Harmony core component and brief description.</p>
<br /><img class="image" src="GUID-2CAD49E7-5583-410B-A4B3-EC31DE50C589-low.png" alt="harmony_core_mhc_config" /><br /><ul class="ul"><li class="li"><p class="p"><strong class="ph b">All of below mentioned options are enabled or disabled automatically based on the any driver, system service or middleware components added into the project graph. Disabling any of these symbols may lead to build errors in the dependent module</strong></p>
</li>
<li class="li"><p class="p"><strong class="ph b">configuration.h</strong> header file will be generated only when one of the below common symbols or application file option is selected</p>
</li>
<li class="li"><p class="p"><strong class="ph b">For Example:</strong> In above snapshot as Memory driver is added to project graph, few of the common symbols are enabled and made Read-Only to avoid accidental disabling.</p>
</li>
<li class="li"><p class="p"><strong class="ph b">Refer to Individual Library help for more details</strong></p>
</li>
</ul>
<p class="p"><strong class="ph b">Configuration Options</strong></p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">Generate Harmony Application Files:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to generate Harmony application template source and header files.</p>
</li>
<li class="li"><p class="p">These generated files can be used as starting point by the developer to develop his application</p>
</li>
<li class="li"><p class="p"><strong class="ph b">Application Configuration:</strong></p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">Number of Applications:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies the number of application template source and header files to be generated.</p>
</li>
<li class="li"><p class="p"><strong class="ph b">Application n Configuration:</strong></p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">Enable Application n Configuration:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to disable or enable generation of current instance of application files</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Application Name:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies the name of the application source and header files to be generated. By default a number sequence will be prefixed based on instances. Below are the files generated if name is <strong class="ph b">app</strong></p>
<ul class="ul"><li class="li"><p class="p">app.c</p>
</li>
<li class="li"><p class="p">app.h</p>
</li>
</ul>
</li>
<li class="li"><p class="p">User can update this field to provide custom names as required. The name must be valid C-language identifier, short and in lowercase</p>
</li>
<li class="li"><p class="p">An asscociated task routine <strong class="ph b">APP_Tasks()</strong> will be generated in application source file and will be called from <strong class="ph b">SYS_Tasks()</strong> routine</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">RTOS Settings:</strong></p>
<ul class="ul"><li class="li"><p class="p">This configuration is displayed when any RTOS is added into project graph</p>
</li>
<li class="li"><p class="p"><strong class="ph b">Stack Size (in bytes):</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies the number of bytes to be allocated on the stack for the current application task</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Task Priority:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies priority for the application task thread. The value can vary based on RTOS used</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Use Task Delay?</strong></p>
<ul class="ul"><li class="li"><p class="p">When enabled the application task will be scheduled out voluntarily after every run based on the delay configured.</p>
</li>
<li class="li"><p class="p"><strong class="ph b">Task Delay:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies the duration the task has to go to sleep after every run.</p>
</li>
<li class="li"><p class="p">Should be configured carefully based on the application need and number of task running along in the system</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Generate Harmony Driver Common Files:</strong></p>
<ul class="ul"><li class="li"><p class="p">When enabled generates the driver common header files required by all Harmony Drivers</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Generate Harmony System Service Common Files:</strong></p>
<ul class="ul"><li class="li"><p class="p">When enabled generates the system service common header files required by all Harmony System services and Drivers.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Generate Harmony System Media Files:</strong></p>
<ul class="ul"><li class="li"><p class="p">When enabled generates the system media header file required by Media block drivers and File System Service.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable System Interrupt:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable System Interrupt library</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable System Ports:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable System Ports library</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable System Cache:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable System Cache library</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable System DMA:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable System DMA library</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable System Reset:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable System Reset library</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Enable OSAL:</strong></p>
<ul class="ul"><li class="li"><p class="p">This option can be used to enable OSAL (Operating System Abstraction Layer) library</p>
</li>
<li class="li"><p class="p">OSAL will get auto enabled and set to "BareMetal" when Middleware or any Driver is instantiated. If any Third-Party Library i.e. RTOS is added then the respective OSAL Layer code will get generated.</p>
<ul class="ul"><li class="li"><p class="p">For instance if user instantiates FreeRTOS, then OSAL is set to <strong class="ph b">FreeRTOS</strong> and <strong class="ph b">osal_freertos.c</strong> code will get generated during code generation.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="p"><strong class="ph b">RTOS Settings For MicriumOS-III RTOS</strong></p>
<p class="p">Below additional options are visible in <strong class="ph b">Application instance RTOS settings</strong> when the MicriumOS-III is added into project graph</p>
<br /><img class="image" src="GUID-B3EFA16B-3DAF-49D1-9E11-DBA535F90156-low.png" alt="rtos_settings_micrium_os_iii" /><br /><ul class="ul"><li class="li"><p class="p"><strong class="ph b">Maximum Message Queue Size:</strong></p>
<ul class="ul"><li class="li"><p class="p">This argument specifies the maximum number of messages that the task can receive through internal message queue.</p>
<ul class="ul"><li class="li"><p class="p">A MicriumOS-III task contains an optional internal message queue (if OS_CFG_TASK_Q_EN is set to DEF_ENABLED in os_cfg.h).</p>
</li>
</ul>
</li>
<li class="li"><p class="p">The user may specify that the task is unable to receive messages by setting this argument to 0</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Task Time Quanta:</strong></p>
<ul class="ul"><li class="li"><p class="p">The amount of time (in clock ticks) for the time quanta when Round Robin is enabled.</p>
</li>
<li class="li"><p class="p">If you specify 0, then the default time quanta will be used which is the tick rate divided by 10.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Task Specific Options:</strong></p>
<ul class="ul"><li class="li"><p class="p">Contains task-specific options. Each option consists of one bit. The option is selected when the bit is set.</p>
</li>
<li class="li"><p class="p">The current version of MicriumOS-III supports the following options:</p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">Stack checking is allowed for the task:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies whether stack checking is allowed for the task</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Stack needs to be cleared:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies whether the stack needs to be cleared</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Floating-point registers needs to be saved:</strong></p>
<ul class="ul"><li class="li"><p class="p">Specifies whether floating-point registers are saved.</p>
</li>
<li class="li"><p class="p">This option is only valid if the processor has floating-point hardware and the processor-specific code saves the floating-point registers</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">TLS (Thread Local Storage) support needed for the task:</strong></p>
<ul class="ul"><li class="li"><p class="p">If the caller doesn�t want or need TLS (Thread Local Storage) support for the task being created.</p>
</li>
<li class="li"><p class="p">If you do not include this option, TLS will be supported by default. TLS support was added in V3.03.00</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-C04D97AB-D6E0-4CF5-9A80-CA64E36B6199.html">MPLAB® Harmony Core Library</a></div>
</div>
</div></body>
</html>